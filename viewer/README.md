# OpenWord Lexicon - Interactive Trie Viewer

Visualize and explore the OpenWord Lexicon's trie data structure in your browser.

## Quick Start

```bash
# From project root
make viewer-web

# Server will start at: http://localhost:8080
# Requires: pnpm (install with: npm install -g pnpm)
# Requires: Run 'make build-en' first to generate wordlist data
```

## Two Viewing Modes

### index.html - Dynamic Trie Builder

Builds the trie from the wordlist dynamically in your browser.

**Features:**
- Loads plain text wordlist from `/data/build/en/wordlist.txt`
- Builds trie structure in browser (takes ~5-10 seconds for full lexicon)
- Progress indicator during build
- Full trie functionality once loaded

**Best for:**
- Quick testing without pre-building
- Exploring smaller word lists
- Understanding how tries are constructed

**Access:** http://localhost:8080/index.html

### index-binary.html - Binary Trie Loader

Loads a pre-built, highly compressed binary trie for instant loading.

**Features:**
- Loads binary trie from `/data/en.trie.bin`
- Instant loading (~100-200ms)
- Smaller file size (~50-70% compression)
- DAWG (Directed Acyclic Word Graph) structure with node deduplication

**Best for:**
- Production use
- Large lexicons
- Fast iteration during development

**Access:** http://localhost:8080/index-binary.html

**Requirements:** Build the binary trie first:
```bash
make build-trie
```

## Features

Both viewers provide:

- **Prefix Search**: Type to see all words starting with your prefix
- **Word Validation**: Check if a word exists in the lexicon
- **Random Words**: Generate random words, optionally filtered by prefix
- **Trie Statistics**:
  - Total word count
  - Node count (for binary trie)
  - Compression ratio (bytes per word)
  - File size

## How It Works

### Dynamic Trie (index.html)

1. Fetches wordlist.txt via HTTP
2. Splits into individual words
3. Inserts each word into a trie data structure
4. Ready for queries

**Trie Structure:**
- Each node represents a character
- Paths from root to terminal nodes spell words
- Shared prefixes = shared nodes = memory efficient

### Binary Trie (index-binary.html)

1. Fetches pre-built .trie.bin file
2. Parses compact binary format
3. Reconstructs DAWG in memory
4. Ready for queries

**DAWG Optimization:**
- Trie nodes with identical suffixes are merged
- Further reduces memory and file size
- Built using `src/build-trie.ts`

## Building Binary Trie

The binary trie is built from the wordlist using a Node.js script:

```bash
# Build from default location (requires make build-en first)
make build-trie

# Or manually with custom paths
cd viewer
pnpm run build-trie -- /path/to/wordlist.txt data/output.trie.bin
```

**Output:**
- `viewer/data/en.trie.bin` - Compressed binary trie
- Statistics printed to console (compression ratio, node count, etc.)

## File Format

### Binary Trie Format

The .trie.bin files use a custom compact format:

**Header (12 bytes):**
- Magic: "OWTRIE" (6 bytes)
- Version: uint16 (2 bytes)
- Word count: uint32 (4 bytes)

**Nodes (variable):**
Each node contains:
- Flags byte: bit 7 = is_terminal, bits 0-6 = child_count
- Children: array of (char_code: uint8, node_id: uint16) pairs

**Properties:**
- Little-endian byte order
- Sorted children for binary search
- Node IDs assigned in post-order
- Duplicate nodes merged (DAWG minimization)

See `src/build-trie.ts` for implementation details.

## Development

### Project Structure

```
viewer/
├── index.html              # Dynamic trie builder
├── index-binary.html       # Binary trie loader
├── src/
│   ├── build-trie.ts      # Binary trie builder (Node.js)
│   └── binary-trie.js     # Browser binary trie parser
├── package.json           # Dependencies and scripts
└── data/                  # Generated binary tries (gitignored)
    └── en.trie.bin
```

### Scripts

```bash
# Install dependencies
pnpm install

# Build binary trie from wordlist
pnpm run build-trie [input.txt] [output.bin]

# Start development server
pnpm start
```

### Dependencies

- **tsx** - TypeScript execution for build-trie.ts
- **http-server** - Local development server
- **typescript** - Type checking

## Requirements

- **pnpm**: JavaScript package manager
  ```bash
  npm install -g pnpm
  ```

- **Wordlist**: Generated by `make build-en`
  - Location: `data/build/en/wordlist.txt`
  - Plain text, one word per line

## Troubleshooting

### "Wordlist not found" error

Run the build first:
```bash
make build-en
```

This generates `data/build/en/wordlist.txt` required by the viewer.

### "Binary trie not found" error

Build the binary trie:
```bash
make build-trie
```

This generates `viewer/data/en.trie.bin`.

### CORS errors

The viewer must be served via HTTP, not opened as `file://`.

**Solution:** Use `make viewer-web` which starts an HTTP server.

### Binary trie vs wordlist path mismatch

The viewer expects:
- Wordlist: `/data/build/en/wordlist.txt`
- Binary trie: `/data/en.trie.bin`

The paths are relative to the server root (project root when using `make viewer-web`).

## Performance

### Dynamic Trie (index.html)

- **Load time**: ~5-10 seconds for full lexicon (~1.3M words)
- **File size**: ~10-15 MB uncompressed text
- **Memory**: ~50-100 MB in browser
- **Rebuild**: Every page load

### Binary Trie (index-binary.html)

- **Load time**: ~100-200 ms
- **File size**: ~3-5 MB compressed binary
- **Memory**: ~20-40 MB in browser
- **Rebuild**: Only when wordlist changes

**Recommendation**: Use binary trie for development and production.

## Use Cases

- **Lexicon Exploration**: Browse the full word list interactively
- **Word Validation**: Check if words exist in the lexicon
- **Prefix Analysis**: See all words with a given prefix
- **Vocabulary Games**: Random word generation
- **Debugging**: Verify build output
- **Education**: Visualize trie data structures

## License

Part of the OpenWord Lexicon project. See main repository for license details.

## See Also

- [Word List Builder](../tools/wordlist-builder/) - Create custom filtered word lists
- [Main README](../README.md) - Project overview
- [DATASETS.md](../docs/DATASETS.md) - Source data documentation
